{% extends 'base.html.twig' %}
{% import 'macros/flash.html.twig' as _flash %}

{% block body %}

    <header>
        {% include("components/navbar.html.twig") %}
    </header>

    <div style="margin-top: 40px;" class="container">
        <div class="card-panel center-align">
            <h3 style="margin-top: 0; margin-bottom: 6px; color: #0c3565">Kompo</h3>

            {% if error %}
                {{ _flash.message(error.messageKey | trans(error.messageData, 'security'), 'red') }}
            {% endif %}

            {% for message in app.flashes('success') %}
                {{ _flash.message(message, 'green') }}
            {% endfor %}

            {% for message in app.flashes('christmas_code') %}
                <div class="card-panel center-align" style="background-color: transparent; box-shadow: none; padding-top: 0;padding-bottom: 0;">
                    <span class="reset pastille christmas_code">M36S3</span>
                </div>
            {% endfor %}

            <form action="{{ path('login') }}" method="POST">
                <div class="container">
                    <div class="input-field">
                        <i class="material-icons prefix">account_circle</i>
                        <input id="username" name="_username" type="text" autocapitalize="off" class="validate" value="{{ lastUsername }}" required>
                        <label for="username">Pseudo</label>
                    </div>
                    <div class="input-field">
                        <i class="material-icons prefix">lock</i>
                        <input id="password" name="_password" type="password" class="validate" required>
                        <label for="password">Mot de passe</label>
                    </div>
                    <div class="checkbox">
                        <label>
                            <input type="checkbox" name="_remember_me" />
                            <span>Rester connecté</span>
                        </label>
                    </div>

                    <span class="hide pastille reset christmas_code">2B5Q7</span>
                </div>

                <button class="btn waves-effect blue lighten-2"><i class="material-icons prefix">check</i> C'est parti !</button>
            </form>

            <br><a href="{{ path('login.forgotten.password') }}">Mot de passe oublié</a>
        </div>
    </div>

    <script type="application/javascript">
        let checkboxRememberMe = $("input[name='_remember_me']");
        let christmasCode = $("span.christmas_code");
        checkboxRememberMe.on('change', function () {
            if (!checkboxRememberMe.is(":checked")) christmasCode.addClass('hide');
            else christmasCode.removeClass('hide');
        });
    </script>

{% endblock %}