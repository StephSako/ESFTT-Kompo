{% extends 'base.html.twig' %}
{% import 'macros/flash.html.twig' as _flash %}
{% block style %}
    <link type="text/css" rel="stylesheet" href="{{ asset('ckeditor5/ckeditor.scss') }}" media="screen,projection" />
{% endblock %}

{% block title %}{{ title }}{% endblock %}

{% block body %}

    <header>
        {% include("components/navbar.html.twig") %}
    </header>

    <div class="container" id="settings-page">

        {% for message in app.flashes('success') %}
            {{ _flash.message(message, 'green') }}
        {% endfor %}

        {% for message in app.flashes('fail') %}
            {{ _flash.message(message, 'red') }}
        {% endfor %}

        <div class="card-panel center-align white-text title_journee">
            <h4 style="font-family: Lobster, cursive">{{ title }}</h4>
        </div>

        <div class="card-panel" id="ckeditor-render">
            {% if showConcernedPlayers %}
                <h5><b>Comp√©titeurs concern√©s</b></h5>
                {% if concernedPlayers|length %}
                    <table class="striped responsive-table">
                        <thead>
                            <tr>
                                <th>Nom</th>
                                <th>Pr√©nom</th>
                                <th>Cat√©gorie</th>
                                <th>N¬∞ licence</th>
                            </tr>
                        </thead>

                        <tbody>
                            {% for player in concernedPlayers %}
                                <tr>
                                    <td>{{ player.nom }}</td>
                                    <td>{{ player.prenom }}</td>
                                    <td {% if player.categorieAgeLabel is null %}class="red-text"{% endif %}>{{ player.categorieAgeLabel ?: '√Çge ind√©fini' }}</td>
                                    <td>{{ player.licence }}</td>
                                </tr>
                            {% endfor %}
                            <tr class="hide-on-med-and-up">
                                <td></td>
                                <td></td>
                                <td></td>
                                <td>
                                    <span class="reset pastille christmas_code">59D7K</span>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                {% else %}
                    <p class="center"><i>Aucun joueur ne participe au {{ label | lower }} pour le moment ...</i></p>
                {% endif %}
            {% endif %}
            <p {% if not HTMLContent %}class="center"{% endif %}>
                {% if HTMLContent %}{{ HTMLContent | raw }}
                {% else %}<i>Il n'y a pas de contenu pour le moment ...</i>
                {% endif %}
            </p>
        </div>

        {% if 'ROLE_ADMIN' in app.token.roleNames %}
            <div class="card-panel" id="settings-form">
                {{ form_start(form) }}
                    <div class="center">
                        <h5 style="font-family: Lobster, cursive; margin-top: 0;">Formulaire d'√©dition administrateur</h5><br>

                        <div class="row">
                            <div class="col s12 m8 offset-m2 l6 offset-l3">
                                <b><i class="material-icons prefix">short_text</i> Titre</b>{{ form_row(form.title) }}
                            </div>
                        </div>

                        <div id="editor"></div>

                        <br>
                        <button class="btn waves-effect blue lighten-2 btn_gestion">
                            Modifier
                        </button>
                    </div>
                {{ form_end(form) }}
            </div>

            <script type="text/javascript">
                let ckeditor_content = '{{ HTMLContent }}';
            </script>
            <script type="text/javascript" src="{{ asset('ckeditor5/ckeditor.js') }}"></script>
            <script type="text/javascript" src="{{ asset('JS/ckeditor5.min.js') }}"></script>
        {% endif %}

        <div class="card-panel center">
            <h5>[<i>MODE DEVELOPPEMENT</i>] Liste des codes secrets pour tests</h5>
            <p><u>/!\</u> A enlever quand la chasse sera d√©marr√©e <u>/!\</u></p>

            <button class="btn waves-effect blue lighten-2" id="trolling">Afficher</button>

            <div id="div_trolling" class="hide center">
                <span style="font-size: 60px;">ü§°</span>
            </div>

            <script type="text/javascript">
                $('button#trolling').click(() => {
                    $('div#div_trolling').removeClass('hide');
                    $('button#trolling').addClass('hide');
                })
            </script>
        </div>
    </div>
{% endblock %}