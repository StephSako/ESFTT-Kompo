{% if joueurs %}
    {% if sheetDataHasViolations %}
        <div class="pastille red lighten-2 reset">
            <i class="material-icons">error</i> Il y a des erreurs dans le document importé : corrigez les erreurs dans le document et réimportez-le de nouveau
        </div><br>
    {% else %}
        <div class="pastille green lighten-2 reset">
            <i class="material-icons">checklist_rtl</i> Le document est conforme et les joueurs sont prêts à être inscrits
        </div><br>
    {% endif %}

    <script type="text/javascript" defer src="{{ asset('JS/resizeResponsiveTable.min.js') }}"></script>

    <table id="table-to-adapt-columns" class="striped centered responsive-table backoffice-table import-excel-table">
        <thead class="hide-on-med-and-down">
            <tr>
                {% if not sheetDataHasViolations %}
                    <th><i class="material-icons">person_add_alt_1</i></th>
                {% endif %}
                <th>Rôles</th>
                <th>Nom</th>
                <th>Date de naissance</th>
                <th>Certificat médical</th>
                <th>Classement</th>
                <th>Mail(s)</th>
                <th>Téléphone(s)</th>
            </tr>
        </thead>
        <tbody>
            {% for joueur in joueurs %}
                <tr {% if joueur.dejaInscrit %}class="grey-text text-lighten-1"{% endif %}>
                    {% if not sheetDataHasViolations %}
                        <td>
                            <label>
                                <input value="{{ joueur.joueur.username }}" id="{{ joueur.joueur.username }}" type="checkbox" class="filled-in" {% if not joueur.dejaInscrit %}checked="checked"{% endif %} />
                                <span style="padding-left: 20px;vertical-align: middle;height: 21px;"></span>
                            </label>
                        </td>
                    {% endif %}
                    <td style="padding-top: 8px; padding-bottom: 8px;">
                        {% if joueur.joueur.isAdmin %}
                            <span class='new badge red' data-badge-caption='Administrateur'></span>
                        {% endif %}

                        {% if joueur.joueur.isCompetiteur %}
                            {% if joueur.joueur.isAdmin %}<br>{% endif %}
                            <span style="margin-top: 2px" class='new badge green' data-badge-caption='Compétiteur'></span>
                            {% if joueur.joueur.isCritFed %}
                                <br><span style="margin-top: 2px" class='new badge purple' data-badge-caption='Crit. féd.'></span>
                            {% endif %}
                        {% elseif joueur.joueur.isLoisir %}
                            {% if joueur.joueur.isAdmin %}<br>{% endif %}
                            <span style="margin-top: 2px" class='new badge orange' data-badge-caption='Loisir'></span>
                        {% endif %}

                        {% if joueur.joueur.isCapitaine %}
                            {% if joueur.joueur.isAdmin or joueur.joueur.isCompetiteur or joueur.joueur.isLoisir %}<br>{% endif %}
                            <span style="margin-top: 2px" class='new badge blue' data-badge-caption='Capitaine'></span>
                        {% endif %}

                        {% if joueur.joueur.isEntraineur %}
                            {% if joueur.joueur.isAdmin or joueur.joueur.isCompetiteur or joueur.joueur.isLoisir or joueur.joueur.isCapitaine %}<br>{% endif %}
                            <span style="margin-top: 2px" class="new badge brown lighten-1" data-badge-caption="Entraîneur"></span>
                        {% endif %}
                    </td>
                    <td>
                        <span {% if 'nom' in joueur.violations|keys %}class="pastille reset white-text red lighten-2"{% endif %}>
                            {{ joueur.joueur.nom ~ ' ' ~ joueur.joueur.prenom }}
                        </span>
                    </td>
                    <td>
                        <span {% if 'dateNaissance' in joueur.violations|keys %}class="pastille reset white-text red lighten-2"{% endif %}>
                            {% if joueur.joueur.dateNaissance %}
                                {{ joueur.joueur.dateNaissance|date('d/m/Y') }}
                                <br><span class="pastille blue centered">{{ joueur.joueur.categorieAgeLabel }}</span>
                            {% endif %}
                        </span>
                    </td>
                    <td>
                        <span {% if 'anneeCertificatMedical' in joueur.violations|keys %}class="pastille reset white-text red lighten-2"{% endif %}>
                            {{ joueur.joueur.anneeCertificatMedical }}
                        </span>
                    </td>
                    <td>
                        <span {% if 'classementOfficiel' in joueur.violations|keys %}class="pastille reset white-text red lighten-2"{% endif %}>
                            {{ joueur.joueur.classementOfficiel }}
                        </span>
                    </td>
                    <td>
                        <span {% if 'mail' in joueur.violations|keys %}class="pastille reset white-text red lighten-2"{% endif %}>
                            {{ joueur.joueur.mail }}
                        </span>
                        {% if not joueur.joueur.mail2 is null %}
                            <br><span {% if 'mail2' in joueur.violations|keys %}style="margin-top: 2px" class="pastille reset white-text red lighten-2"{% endif %}>
                                {{ joueur.joueur.mail2 }}
                            </span>
                        {% endif %}
                    </td>
                    <td>
                        <span {% if 'phoneNumber' in joueur.violations|keys %}class="pastille reset white-text red lighten-2"{% endif %}>
                            {{ joueur.joueur.phoneNumber | split('', 2) | join(' ') }}
                        </span>
                        {% if not joueur.joueur.phoneNumber2 is null %}
                            <br><span {% if 'phoneNumber2' in joueur.violations|keys %}class="pastille reset white-text red lighten-2"{% endif %}>
                                {{ joueur.joueur.phoneNumber2 | split('', 2) | join(' ')}}
                            </span>
                        {% endif %}
                    </td>
                </tr>
            {% endfor %}
        </tbody>
    </table>

    <a id="annulerImportJoueurs" href="{{ path('backoffice.competiteurs') }}" class="btn waves-effect grey btn_gestion">Annuler</a>
    {% if not sheetDataHasViolations %}
        {# Liste des joueurs cochés à inscrire #}
        <input type="hidden" name="usernamesToRegister" value="">
        <button id="enregistrerJoueurs" onclick="getUsernamesToRegister()" type="submit" class="btn waves-effect blue btn_gestion">Enregistrer</button>
    {% endif %}
{% else %}
    <p><i>Aucun joueur trouvé dans le document importé</i></p>
{% endif %}